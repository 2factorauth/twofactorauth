name: Jekyll site CI

on: [push]

jobs:
  Test_Jekyll:
    runs-on: ubuntu-latest
    name: Test using Docker
    steps:
    - uses: actions/checkout@v1
    - name: Install requirements
      run: |
        sudo apt install libffi-dev nodejs python-dev gcc ruby rails make zlib1g-dev ruby-dev libcurl3 -y
        sudo gem install bundler
        bundle install
    - name: Build site
      run: bundle exec jekyll build
      timeout-minutes: 1
    - name: Test Rake script
      run: bundle exec rake
    - name: Test external links
      run: bundle exec rake proof_external
      continue-on-error: true
      timeout-minutes: 3
